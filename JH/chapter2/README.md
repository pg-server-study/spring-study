# 2장 테스트



## 목차



## 2.1 UserDaoTest 다시 보기

### 2.1.1 테스트의 유용성

1장 에서 만든 UserDao가 기대했떤 대로 동작하는지 확인하기 위해 간단한 테스트 코드를 만들었다.

만든 코드는 어떤 방식으로든 테스트 해야한다.

이전에 만든 코드는 main() 메소드를 이용하여 add(), get() 메소드를 호출하여 눈으로 테스트를 진행하였다.

테스트코드를 실행해가면서 초난감 UserDao코드의 설계와 코드를 리팩토링하였고

리팩토링 하면서 코드를 개선해도 이전과 다를거 없이 기능이 동작하는거를 확인 할 수 있었다.

프로그래머가 테스트코드를 실행하지 않고, 머릿속으로 시뮬레이션 하는 보장되지 않은 방법으로

코드를 작성하는것과는 차원이 다른 안정성을 보장해준다.

테스트코드를 작성함으로 프로그래머가 의도한대로의 기능이 완성되었는지

다른사람이 테스트코드를 실행함으로써 코드의 동작원리를 확인하는것처럼

테스트 코드의 유용점은 어마어마하다.

### 2.1.2 UserDaoTest의 특징

1장에서 만들었떤 main(0 메소드로 작성된 테스트 코드다.

이 테스트 코드를 살펴보자

```
public class UserDaoTest ( 
	public static void main(String... args) throws SQLException ( 
			ApplicationContext context = new GenericXmlApplicationContext("applicationContext.xml"); 
			UserDao dao = context.getBean("userDao", UserDao.class); 

			User user = new User();
			user.setld("user");
			user.setName("백기선"); 
			user.setPassword("married"); 

			dao.add(user);
 
			System.out.println(user.getId() + "등록 성공"); 

			User user2 = dao.get(user.getld()); 
			System.out.println(user2.getName()); 
			System.out.println(user2.getPassword()); 

			System.out.println(user2.getld() + " 조회 성공");
  }
}
```

위의 테스트 코드를 정리해보면 다음과 같다.

- 자바에서 가장 손쉽게 실행 가능한 main() 메소드를 이용한다.
- 테스트할 대상인 UserDao의 오브젝트를 가져와 메소드를 호출한다.
- 테스트에 사용할 입력 값(User 오브젝트) 을 직접 코드에서 만들어  넣어준다.
- 테스트의 결과를 콘솔에 출력해준다.
- 각 단계의 작업이 에러 없이 끝나면 콘솔에 성공 메시지로 출력해준다.

이 테스트 방법에서 가장 돋보이는건, main(0 메소드를 이용해 쉽게 테스트 수행을 가능하게 했다는 점과 테스트할 대상인 userDao를 직접 호출해서 사용한다는 점이다.

**웹을 통한 DAO 테스트 방법의 문제점**

보통 웹 프로그램에서 사용하는 DAO를 테스트하는 방법은 다음과 같다.

DAO를 만든 뒤 바로 테스트하지않고 서비스, MVC 프레젠테이션 계층까지 포함된 모든

입출력 기능을 다 만든 후 웹 화면을 띄우고 form 에 값을 입력하고 폼의 입력값에 대한 객체를 만들고 UserDao를 호출하여 테스트를 진행한다.

이런 방식으로 테스트를 하여 에러가 발생하면 에러 메시지와 호출 스택정보만으로 원일을 찾기가 힘들다. DB 연결 에러인지 SQL 문법이 틀린지 이런방식의 테스트는 정말 불편하고 오류가 있을 때 빠르게 대응 하기가 힘들어진다.

웹을 통한 DAO 방식의 문제점 정리

- 하나의 테스트를 위해 모든 계층을 다 만들어줘야 한다.
- 무언가를 테스트 하려면 웹화면을 하나 간단하게 만들어야한다.
- 에러가 발생할경우 추적이 힘들고 대응도 힘들어진다.

이러한 테스트 방식말고 보다 효율적으로 테스트를 활용 하는 방법을 알아보자.

**작은 단위의 테스트**

테스트 하고자 하는 대상이 명확하다면 그 대상에만 집중해서 테스트 하는것이 바람직하다.

한꺼번에 너무 많은 것을 몰아서 테스트하면 테스트 준비도 길어지고 수행과정도 복잡하고

오류를 찾기도 힘들어진다.



따라서 테스트는 가능하면 작은 단위로 쪼개서 집중해야한다.

UserDaoTest는 한 가지 관심에 집중할 수 있게 작은 단위로 만들어진 테스트다

UserDaoTest를 수행 할때 웹 인터페이스나, 그것을 위한 MVC 클래스 서비스 오브젝트등이 필요없다.

UserDaoTest에서 에러가난다면 UserDao 코드나 DB 연결 방법등 에러의 추적이 훨씬 좁아지며

쉬워진다.

이 처럼 작은 단위의 코드에 대해 테스트를 수행하는것을 단위 테스트라고 한다.

여기서 단위란 무엇인지 그 크기와 범위가 어느정도인지 정해진건 아니다.

UserDao의 add() 메소드 하나에대한 테스트도 단위테스트가 될 수 있다.

이렇게 단위로 나눠서 테스트하는 단위 테스트가 필요한 이유를 좀 더 생각해보자.

```
다른 책을 보다 본 문구가 있다.

테스트 코드를 작성한 개발자와 작성하지 않은 개발자가 있다.

누군가 질문했다 XXX기능에서 X값을 넣고 실행하면 어떤 결과가 나오나요?

테스트 코드를 작성한 개발자는 자신이 만든 테스트코드에 x값을 넣고 바로 실행해보면된다.

하지만 테스트 코드를 작성하지 않은 개발자는 위의 내용처럼 서버를 키고..
웹 인터페이스에 들어가서 form 안에다 x값을 넣고 실행을 해야한다.

이 얼마나 많은 시간이 소요되는것인가? 

또한 테스트 코드를 작성함으로 다른 개발자가 해당 기능이 어떤 기능인지도 보기 편해진다.

즉 유지보수가 쉬워지고 코드의 안정성도 올라간다.
```