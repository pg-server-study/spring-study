# 아키텍쳐

## 소프트웨어 아키텍처의 정의

소프트웨어의 골격이 되는 기본구조 , 건축학에서 건물의 구조를 건축학적으로 설계하듯 컴퓨터 공학에서는 소프트웨어의 구조(아키텍처)를 단계별로 설계하고 구축한다.

가장 단순한 정의를 보자면 어떤 경계 안에 있는 내부 구성요소들이 어떤 책임을 갖고 있고 , 어떤 방식으
로 서로 관계를 맺고 동작히는지를 규정히는 것이라고 할 수 있다.

### 설계 목표 설정

시스템 개발 방향을 명확히 하기 위해 설계에 영향을 주는 비즈니스 목표 , 우선순위 등의 요구사항을 분석하여 전체 시스템 설계의 목표를 설정한다.

## 아키텍처 패턴이란 ?

아키텍처 패턴은 소프트웨어 시스템의 구조를 구성하기 위한 기본적인 윤곽을 제시한다.

서스시스템들과 그 역할이 정의 되어 있으며 , 서브시스템 사이의 관계와 여러 규칙 지침등이 포함되어 있다.

### 아키텍처 패턴의 장점

- 시행착오를 줄여 개발 시간 단축
- 검증된 구조로 개발 할 수있어 안정적인 개발 가능
- 이해관계자들이 공통된 아키텍처를 공유 할 수있어서 의사소통이 간편해짐
- 시스템 구조를 이해하는것이 쉬워짐

## 계층화 패턴 (Layered pattern)

이 패턴은  n티어 아키텍처 패턴이라고도 불린다. 이는 하위 모듈들의 그룹으로 나눌 수 있는 구조화된 프로그램에서 사용할 수 있다. 각 하위 모듈들은 특정한 수준의 추상화를 제공한다. 각 계층은 다음 상위 계층에 서비스를 제공한다.

- **프레젠테이션 계층** (Presentation layer) - **UI 계층** (UI layer) 이라고도 함
- **애플리케이션 계층** (Application layer) - **서비스 계층** (Service layer) 이라고도 함
- **비즈니스 논리 계층** (Business logic layer) - **도메인 계층** (Domain layer) 이라고도 함
- **데이터 접근 계층** (Data access layer) - **영속 계층** (Persistence layer) 이라고도 함

### 모놀리식 아키텍처

모놀리식 서비스 아키텍처는 서비스나 시스템이 한데 모여있는 구성을 말한다.

![image.png](%E1%84%8B%E1%85%A1%E1%84%8F%E1%85%B5%E1%84%90%E1%85%A6%E1%86%A8%E1%84%8E%E1%85%A7%2055fc1eb73d3b4e028ac8832c4099553b/image.png)

( 모놀리식 아키텍처랑 마이크로 서비스 아키텍처와의 비교 )

### 모놀리식 아키텍처의 단점

- 분산처리가 어렵다.
- 코드관리가 어렵고 , 신기술 사용이 어렵다.
- 한기지 언어만 사용해야한다.
- 시스템 안정성이 떨어진다 .

🗨️ 마이크로 서비스란 →  사용자의 요청에 대해 각각의 서버(ex- 결제서버 , 검색서버 )가 분리되어 있어 모놀리식 아키텍처와 다르게 각 서버마다 다른 언어를 사용 할 수있고 , 분산처리가 쉽다 .  

## 오브젝트 중심 아키텍처

오브젝트 중심 아키텍처가 데이터 중심 아키텍처와 다른 가장 큰 특징은 도메인 모델을 반영하는 오브젝트 구조를 만들어두고 그것을 각 계층 사이에서 정보를 전송하는 데 사용한다는 것이다.

카테고리와 상품이라는 모델에서 데이터를 가져온다고 하면, 데이터 중심 아키텍처에서는 SQL에서 조인하여 해당 값을 Map, 배열에 담게 된다. 이걸 서비스 계층에서 받게 되면, DAO 에서 어떤 필드 이름을 사용해서 값을 가져오는지, 몇 개의 필드를 사용하는 지를 다 알아야한다. 특히 필드이름이나 개수가 변경되면 서비스 계층의 코드도 같이 변경되야 하는 문제가 있다.

오브젝트 중심의 아키텍처는 두 개의 도메인을 만들어서 사용하게 된다. SQL의 결과를 두 개의 도메인에 나눠서 넣고, 이 모델은 서비스 계층, DAO 등 어떤 곳에서도 동일하게 사용하게 된다. 도메인에서 서로 간의 레퍼런스를 가지게 하여, Set 등을 통해 어떤 관계를 가지고 있는 지도 확인이 가능하다.

### 빈약한 데이터 오브젝트 아키텍처

도메인 오브젝트에 정보만 담겨있고 정보를 활용하는 아무런 기능도 없는 방식이다. 스프링 개발자가 흔히 사용하는 방식이다. 비즈니스 로직은 모두 서비스 계층에서 처리한다.

### 풍성한 데이터 오브젝트 아키텍처

좀 더 객체지향적인 특징을 살린 방식으로, 도메인 오브젝트가 가진 정보에 깊은 연관이 있는 로직의 경우 해당 도메인 오브젝트에서 처리하도록 하는 것이 풍성한 방식이다.

### 도메인 계층 방식 아키텍처 ( DDD )

지금 까지 살펴본 바로는 도메인 모델을 따르는 오브젝트를 만들고 , 이를 활용하는 방법에는 한계가 있다.

도메인 오브젝트에 담을 수 있는 비즈니스 로직은 데이터 액세스 계층에서 가져온 내부 데이터를 분석 하거나 , 조건에 따라 다시 오브젝트 정보를 변경 생성하는 정도에 그칠수 밖에없다. 이렇게 변경된 정보가 다시 

도메인 오브젝트에 담을 수 있는 비즈니스 로직은 데이터 액세스 계층에서 가져온 내부 데이터를 분석 하거나 , 조건에 따라 다시 오브젝트 정보를 변경 생성하는 정도에 그칠수 밖에없다. 이렇게 변경된 정보가 다시 DB등에 반영 되려면 서비스 계층 오브젝트의 부가적인 작업이 필요하다.

도메인 계층의 역할과 비중을 극대화 하려다 보면 기존의 풍성한 도메인 오브젝트 방식으로는 만족 할수 없다 . 그래서 등장한것이 바로 도메인 오브젝트가 기존 3계층과 같은 레벨로 격상되어 하나의 독립 적인 계층을 이루게하는 도메인 계층 방식이다 .

도메인 계층 방식 아키텍처의 각 계층 

- **표현**: 사용자의 요청을 받아 응용 영역에 전달, 응용 영역의 처리 결과를 다시 사용자에게 보여주는 역할
- **응용**: 기능을 구현하기 위해 도메인 모델 영역의 도메인 모델을 사용
- **도메인**: 도메인 모델을 구현 (엔티티 , 리포지터리 , 도메인서비스 )
- **인프라스트럭처**: 구현 기술에 대한 것을 다룸 (RDMBS 연동 처리 , HTTP 클라이언트를 이용해서 REST API 호출 처리 등 )

## 정리

- 스프링 애플리케이션은 역할에 따라 3계층으로 구분되고 , 다시 기술의 추상도에 따라 세분화되는 계층형 아키텍처를 사용하는 것이 좋다 .
- 아키텍처는 애플리케이션이 다루는 정보의 관점에서 데이터 중심과 오브젝트 중심으로 구분할수 있다.
- 스프링에 가장 잘어울리는 아키텍처는 오브젝트 중심의 아키텍처다 .